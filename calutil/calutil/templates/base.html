{% load static %}
<!DOCTYPE HTML>
<html>
    <head>
        <title>CalUtil</title>
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0;" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

        <link rel="apple-touch-icon" href="icon.png"/>

        <!-- twitter bootstrap stylesheet -->
        <link rel="stylesheet" href="http://twitter.github.com/bootstrap/1.4.0/bootstrap.min.css">

        <!-- we need jQuery -->
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <!-- we need tabs javascript plugin of twitter bootstrap -->
        <script src="http://twitter.github.com/bootstrap/1.4.0/bootstrap-tabs.js"></script>
        <script src="http://twitter.github.com/bootstrap/1.4.0/bootstrap-scrollspy.js"></script>
        <script src="{% static "js/underscore-min.js" %}"></script>
        <script src="{% static "js/backbone-min.js" %}"></script>
        {% block style %}
            <style type="text/css">

                @media all {
                    .panel {
                    overflow                    : hidden;
                    position                    : absolute;
                    display                     : block;
                    width                       : 100%;
                    padding-top                 : 60px;
                    padding-bottom              : 60px;
                    top                         : 0;
                    /*height: 100%; */ /* uncomment if desktop */
                }

                .scrollable {
                    overflow                    : scroll;
                    -webkit-overflow-scrolling  : touch;
                }

                .insideScrollablePanel {
                    margin-left                 : 5%;
                    margin-right                : 5%;
                    width                       : 90%;
                }

                } /* end of medial all */

                /*--- ipad ---*/
                /*--- full screen mode ---*/
                @media (device-width: 768px) and (orientation: portrait) {
                    .panel {
                        height                      : 934px; /*1004-80*/
                    }
                }
                /*--- browser mode ---*/
                @media (device-width: 768px) and (orientation: landscape) {
                    .panel {
                        height                      : 668px; /*748-80*/
                    }
                }

                /*--- iphone ---*/
                /*--- full screen mode ---*/
                @media (max-width: 480px) and (orientation: portrait) {
                    .panel {
                        height                      : 380px; /*460-80*/
                    }
                }
                /*--- browser mode ---*/
                @media (max-width: 480px) and (orientation: landscape) {
                    .panel {
                        height                      : 220px; /*300-80*/
                    }
                }
            </style>
            {% block extra_style %}{% endblock %}
        {% endblock %}
        <script type="text/javascript">
            $(function(){
                Course = Backbone.Model.extend({
                });
                CourseCollection = Backbone.Collection.extend({
                    model: Course,
                    url: "/app_data/course/?format=json&limit=20",
                    parse: function(data) {
                        if (!data)
                            return []; 
                        this.url = data.meta.next;
                        return data.objects;//parse out the objects list
                    },
                });
                CoursesView = Backbone.View.extend({
                    initialize: function(){
                        this.el = this.options.el;
                        this.collection = new CourseCollection();
                        this.fetch();
                    },
                    fetch: function(){
                        var view = this;
                        this.collection.fetch({
                            success: function(data){
                                view.render();
                            },
                        });
                    },
                    render: function(){
                        var e = this.el;
                        $.each(this.collection.models, function(index,course){
                            var template = _.template($("#course_template").html(),{name: course.attributes.abbreviation,instructor: course.attributes.instructor,enrolled: course.attributes.enrolled, url: course.attributes.url});
                            $(template).appendTo($(e));
                        });
                    }
                });
            });
        </script>
    </head>
    <body>
            <!-- TOP BAR -->
            {% block topbar_base %}
                <div class="topbar">
                    <div class="topbar-inner">
                        <div class="container-fluid">
                            {% block brand %}
                                <a class="brand" href="#">{% block brand_name %}CalUtil{% endblock %}</a>
                            {% endblock %}
                            <ul class="nav">
                                {% block topbar_links %}
                                {% endblock %}
                            </ul>
                        </div>
                    </div>
                </div>
            {% endblock %}

            {% block content %}
            {% endblock %}
    </body>
    {% block extra_script %}
    {% endblock %}
</html>
